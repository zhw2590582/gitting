!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Gitting=e()}(this,function(){"use strict";var o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t},u=function(){},M={},c=[],l=[];function p(t,e){var n,r,o,i,a=l;for(i=arguments.length;2<i--;)c.push(arguments[i]);for(e&&null!=e.children&&(c.length||c.push(e.children),delete e.children);c.length;)if((r=c.pop())&&void 0!==r.pop)for(i=r.length;i--;)c.push(r[i]);else"boolean"==typeof r&&(r=null),(o="function"!=typeof t)&&(null==r?r="":"number"==typeof r?r=String(r):"string"!=typeof r&&(o=!1)),o&&n?a[a.length-1]+=r:a===l?a=[r]:a.push(r),n=o;var s=new u;return s.nodeName=t,s.children=a,s.attributes=null==e?void 0:e,s.key=null==e?void 0:e.key,void 0!==M.vnode&&M.vnode(s),s}function D(t,e){for(var n in e)t[n]=e[n];return t}function f(t,e){null!=t&&("function"==typeof t?t(e):t.current=e)}var e="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function t(t,e){return p(t.nodeName,D(D({},t.attributes),e),2<arguments.length?[].slice.call(arguments,2):t.children)}var h=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,n=[];function a(t){!t._dirty&&(t._dirty=!0)&&1==n.push(t)&&(M.debounceRendering||e)(s)}function s(){for(var t;t=n.pop();)t._dirty&&A(t)}function $(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function C(t){var e=D({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===e[r]&&(e[r]=n[r]);return e}function L(t){var e=t.parentNode;e&&e.removeChild(t)}function d(t,e,n,r,o){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)f(n,null),f(r,t);else if("class"!==e||o)if("style"===e){if(r&&"string"!=typeof r&&"string"!=typeof n||(t.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var i in n)i in r||(t.style[i]="");for(var i in r)t.style[i]="number"==typeof r[i]&&!1===h.test(i)?r[i]+"px":r[i]}}else if("dangerouslySetInnerHTML"===e)r&&(t.innerHTML=r.__html||"");else if("o"==e[0]&&"n"==e[1]){var a=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),r?n||t.addEventListener(e,g,a):t.removeEventListener(e,g,a),(t._listeners||(t._listeners={}))[e]=r}else if("list"!==e&&"type"!==e&&!o&&e in t){try{t[e]=null==r?"":r}catch(t){}null!=r&&!1!==r||"spellcheck"==e||t.removeAttribute(e)}else{var s=o&&e!==(e=e.replace(/^xlink:?/,""));null==r||!1===r?s?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof r&&(s?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),r):t.setAttribute(e,r))}else t.className=r||""}function g(t){return this._listeners[t.type](M.event&&M.event(t)||t)}var O=[],N=0,m=!1,v=!1;function I(){for(var t;t=O.shift();)M.afterMount&&M.afterMount(t),t.componentDidMount&&t.componentDidMount()}function E(t,e,n,r,o,i){N++||(m=null!=o&&void 0!==o.ownerSVGElement,v=null!=t&&!("__preactattr_"in t));var a=T(t,e,n,r,i);return o&&a.parentNode!==o&&o.appendChild(a),--N||(v=!1,i||I()),a}function T(t,e,n,r,o){var i=t,a=m;if(null!=e&&"boolean"!=typeof e||(e=""),"string"==typeof e||"number"==typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||o)?t.nodeValue!=e&&(t.nodeValue=e):(i=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(i,t),Y(t,!0))),i.__preactattr_=!0,i;var s=e.nodeName;if("function"==typeof s)return function(t,e,n,r){var o=t&&t._component,i=o,a=t,s=o&&t._componentConstructor===e.nodeName,u=s,c=C(e);for(;o&&!u&&(o=o._parentComponent);)u=o.constructor===e.nodeName;o&&u&&(!r||o._component)?(P(o,c,3,n,r),t=o.base):(i&&!s&&(H(i),t=a=null),o=j(e.nodeName,c,n),t&&!o.nextBase&&(o.nextBase=t,a=null),P(o,c,1,n,r),t=o.base,a&&t!==a&&(a._component=null,Y(a,!1)));return t}(t,e,n,r);if(m="svg"===s||"foreignObject"!==s&&m,s=String(s),(!t||!$(t,s))&&(i=function(t,e){var n=e?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);return n.normalizedNodeName=t,n}(s,m),t)){for(;t.firstChild;)i.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(i,t),Y(t,!0)}var u=i.firstChild,c=i.__preactattr_,l=e.children;if(null==c){c=i.__preactattr_={};for(var f=i.attributes,h=f.length;h--;)c[f[h].name]=f[h].value}return!v&&l&&1===l.length&&"string"==typeof l[0]&&null!=u&&void 0!==u.splitText&&null==u.nextSibling?u.nodeValue!=l[0]&&(u.nodeValue=l[0]):(l&&l.length||null!=u)&&function(t,e,n,r,o){var i,a,s,u,c,l=t.childNodes,f=[],h={},p=0,d=0,g=l.length,m=0,v=e?e.length:0;if(0!==g)for(var y=0;y<g;y++){var b=l[y],w=b.__preactattr_,_=v&&w?b._component?b._component.__key:w.key:null;null!=_?(p++,h[_]=b):(w||(void 0!==b.splitText?!o||b.nodeValue.trim():o))&&(f[m++]=b)}if(0!==v)for(var y=0;y<v;y++){u=e[y],c=null;var _=u.key;if(null!=_)p&&void 0!==h[_]&&(c=h[_],h[_]=void 0,p--);else if(d<m)for(i=d;i<m;i++)if(void 0!==f[i]&&(k=a=f[i],S=o,"string"==typeof(x=u)||"number"==typeof x?void 0!==k.splitText:"string"==typeof x.nodeName?!k._componentConstructor&&$(k,x.nodeName):S||k._componentConstructor===x.nodeName)){c=a,f[i]=void 0,i===m-1&&m--,i===d&&d++;break}c=T(c,u,n,r),s=l[y],c&&c!==t&&c!==s&&(null==s?t.appendChild(c):c===s.nextSibling?L(s):t.insertBefore(c,s))}var k,x,S;if(p)for(var y in h)void 0!==h[y]&&Y(h[y],!1);for(;d<=m;)void 0!==(c=f[m--])&&Y(c,!1)}(i,l,n,r,v||null!=c.dangerouslySetInnerHTML),function(t,e,n){var r;for(r in n)e&&null!=e[r]||null==n[r]||d(t,r,n[r],n[r]=void 0,m);for(r in e)"children"===r||"innerHTML"===r||r in n&&e[r]===("value"===r||"checked"===r?t[r]:n[r])||d(t,r,n[r],n[r]=e[r],m)}(i,e.attributes,c),m=a,i}function Y(t,e){var n=t._component;n?H(n):(null!=t.__preactattr_&&f(t.__preactattr_.ref,null),!1!==e&&null!=t.__preactattr_||L(t),y(t))}function y(t){for(t=t.lastChild;t;){var e=t.previousSibling;Y(t,!0),t=e}}var b=[];function j(t,e,n){var r,o=b.length;for(t.prototype&&t.prototype.render?(r=new t(e,n),_.call(r,e,n)):((r=new _(e,n)).constructor=t,r.render=w);o--;)if(b[o].constructor===t)return r.nextBase=b[o].nextBase,b.splice(o,1),r;return r}function w(t,e,n){return this.constructor(t,n)}function P(t,e,n,r,o){t._disable||(t._disable=!0,t.__ref=e.ref,t.__key=e.key,delete e.ref,delete e.key,void 0===t.constructor.getDerivedStateFromProps&&(!t.base||o?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,r)),r&&r!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=r),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==n&&(1!==n&&!1===M.syncComponentUpdates&&t.base?a(t):A(t,1,o)),f(t.__ref,t))}function A(t,e,n,r){if(!t._disable){var o,i,a,s=t.props,u=t.state,c=t.context,l=t.prevProps||s,f=t.prevState||u,h=t.prevContext||c,p=t.base,d=t.nextBase,g=p||d,m=t._component,v=!1,y=h;if(t.constructor.getDerivedStateFromProps&&(u=D(D({},u),t.constructor.getDerivedStateFromProps(s,u)),t.state=u),p&&(t.props=l,t.state=f,t.context=h,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(s,u,c)?v=!0:t.componentWillUpdate&&t.componentWillUpdate(s,u,c),t.props=s,t.state=u,t.context=c),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!v){o=t.render(s,u,c),t.getChildContext&&(c=D(D({},c),t.getChildContext())),p&&t.getSnapshotBeforeUpdate&&(y=t.getSnapshotBeforeUpdate(l,f));var b,w,_=o&&o.nodeName;if("function"==typeof _){var k=C(o);(i=m)&&i.constructor===_&&k.key==i.__key?P(i,k,1,c,!1):(b=i,t._component=i=j(_,k,c),i.nextBase=i.nextBase||d,i._parentComponent=t,P(i,k,0,c,!1),A(i,1,n,!0)),w=i.base}else a=g,(b=m)&&(a=t._component=null),(g||1===e)&&(a&&(a._component=null),w=E(a,o,c,n||!p,g&&g.parentNode,!0));if(g&&w!==g&&i!==m){var x=g.parentNode;x&&w!==x&&(x.replaceChild(w,g),b||(g._component=null,Y(g,!1)))}if(b&&H(b),(t.base=w)&&!r){for(var S=t,$=t;$=$._parentComponent;)(S=$).base=w;w._component=S,w._componentConstructor=S.constructor}}for(!p||n?O.push(t):v||(t.componentDidUpdate&&t.componentDidUpdate(l,f,y),M.afterUpdate&&M.afterUpdate(t));t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);N||r||I()}}function H(t){M.beforeUnmount&&M.beforeUnmount(t);var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var n=t._component;n?H(n):e&&(null!=e.__preactattr_&&f(e.__preactattr_.ref,null),L(t.nextBase=e),b.push(t),y(e)),f(t.__ref,null)}function _(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{},this._renderCallbacks=[]}function k(t,e,n){return E(n,t,{},!1,e,!1)}function x(){return{}}D(_.prototype,{setState:function(t,e){this.prevState||(this.prevState=this.state),this.state=D(D({},this.state),"function"==typeof t?t(this.state,this.props):t),e&&this._renderCallbacks.push(e),a(this)},forceUpdate:function(t){t&&this._renderCallbacks.push(t),A(this,2)},render:function(){}});var S={h:p,createElement:p,cloneElement:t,createRef:x,Component:_,render:k,rerender:s,options:M},U=Object.freeze({default:S,h:p,createElement:p,cloneElement:t,createRef:x,Component:_,render:k,rerender:s,options:M});"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function W(t,e){return t(e={exports:{}},e.exports),e.exports}var z=W(function(e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=r=function(t){return n(t)}:e.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},r(t)}e.exports=r});var F=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t};var B=function(t,e){return!e||"object"!==z(e)&&"function"!=typeof e?F(t):e},G=W(function(e){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(t)}e.exports=n}),R=W(function(n){function r(t,e){return n.exports=r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},r(t,e)}n.exports=r});var J,V=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&R(t,e)},Z=(J=U)&&J.default||J,q=W(function(t,e){var l=Z;function f(t,e){for(var n in e)t[n]=e[n];return t}function n(t){this.getChildContext=function(){return{store:t.store}}}n.prototype.render=function(t){return t.children&&t.children[0]||t.children},e.connect=function(u,c){var r;return"function"!=typeof u&&("string"==typeof(r=u||{})&&(r=r.split(/\s*,\s*/)),u=function(t){for(var e={},n=0;n<r.length;n++)e[r[n]]=t[r[n]];return e}),function(s){function t(r,t){var o=this,i=t.store,a=u(i?i.getState():{},r),e=c?function(t,e){"function"==typeof t&&(t=t(e));var n={};for(var r in t)n[r]=e.action(t[r]);return n}(c,i):{store:i},n=function(){var t=u(i?i.getState():{},r);for(var e in t)if(t[e]!==a[e])return a=t,o.setState({});for(var n in a)if(!(n in t))return a=t,o.setState({})};this.componentWillReceiveProps=function(t){r=t,n()},this.componentDidMount=function(){i.subscribe(n)},this.componentWillUnmount=function(){i.unsubscribe(n)},this.render=function(t){return l.h(s,f(f(f({},e),t),a))}}return(t.prototype=new l.Component).constructor=t}},e.Provider=n}),Q=q.connect,K=q.Provider;var X=function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}};var tt=function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)};var et=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")};var nt=function(t){return X(t)||tt(t)||et()};function rt(t,e){for(var n in e)t[n]=e[n];return t}var ot=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},it="gitting_settings";function at(t){var e=JSON.parse(window.localStorage.getItem(it))||{};return t?e[t]:e}function st(t,e){var n=Object.assign({},at(),ot({},t,e));return window.localStorage.setItem(it,JSON.stringify(n))}function ut(){return window.localStorage.removeItem(it)}function ct(e){return Object.keys(e).map(function(t){return"".concat(t,"=").concat(window.encodeURIComponent(e[t]||""))}).join("&")}function lt(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return window.scroll({behavior:"smooth",left:0,top:t.getBoundingClientRect().top+window.scrollY+e}),t}var ft={isLogin:function(){return!!at("token")&&!!at("userInfo")},userInfo:{},issue:{},comments:[],error:"",input:""},ht=function(a){var i=[];function e(t){for(var e=[],n=0;n<i.length;n++)i[n]===t?t=null:e.push(i[n]);i=e}function n(t,e,n){a=e?t:rt(rt({},a),t);for(var r=i,o=0;o<r.length;o++)r[o](a,n)}return a=a||{},{action:function(o){function i(t){n(t,!1,o)}return function(){for(var t=arguments,e=[a],n=0;n<arguments.length;n++)e.push(t[n]);var r=o.apply(this,e);if(null!=r)return r.then?r.then(i):i(r)}},setState:n,subscribe:function(t){return i.push(t),function(){e(t)}},unsubscribe:e,getState:function(){return a}}}(ft),pt=function(t){return{throwError:function(t,e,n){return{error:e?n:""}},setUserInfo:function(t,e){return{userInfo:e}},setIssue:function(t,e){return{issue:e}},setComments:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=nt(t.comments);return e.forEach(function(e){n.find(function(t){return t.id===e.id})||n.push(e)}),{comments:n}},setInput:function(t,e){return{input:e}},logout:function(t,e){e&&e.preventDefault(),ut(),window.location.reload()},login:function(t,e,n){n&&n.preventDefault(),st("redirect_uri",window.location.href),window.location.href="http://github.com/login/oauth/authorize?".concat(ct({state:"Gitting",client_id:e.clientID,redirect_uri:window.location.href,scope:"public_repo"}))}}},dt=W(function(t){var e=function(i){var u,t=Object.prototype,c=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",r=e.toStringTag||"@@toStringTag";function a(t,e,n,r){var o=e&&e.prototype instanceof s?e:s,i=Object.create(o.prototype),a=new D(r||[]);return i._invoke=function(i,a,s){var u=f;return function(t,e){if(u===p)throw new Error("Generator is already running");if(u===d){if("throw"===t)throw e;return L()}for(s.method=t,s.arg=e;;){var n=s.delegate;if(n){var r=S(n,s);if(r){if(r===g)continue;return r}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(u===f)throw u=d,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);u=p;var o=l(i,a,s);if("normal"===o.type){if(u=s.done?d:h,o.arg===g)continue;return{value:o.arg,done:s.done}}"throw"===o.type&&(u=d,s.method="throw",s.arg=o.arg)}}}(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=a;var f="suspendedStart",h="suspendedYield",p="executing",d="completed",g={};function s(){}function m(){}function v(){}var y={};y[o]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(C([])));w&&w!==t&&c.call(w,o)&&(y=w);var _=v.prototype=s.prototype=Object.create(y);function k(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function x(u){var e;this._invoke=function(n,r){function t(){return new Promise(function(t,e){!function e(t,n,r,o){var i=l(u[t],u,n);if("throw"!==i.type){var a=i.arg,s=a.value;return s&&"object"==typeof s&&c.call(s,"__await")?Promise.resolve(s.__await).then(function(t){e("next",t,r,o)},function(t){e("throw",t,r,o)}):Promise.resolve(s).then(function(t){a.value=t,r(a)},function(t){return e("throw",t,r,o)})}o(i.arg)}(n,r,t,e)})}return e=e?e.then(t,t):t()}}function S(t,e){var n=t.iterator[e.method];if(n===u){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=u,S(t,e),"throw"===e.method))return g;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,g;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=u),e.delegate=null,g):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function $(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function D(t){this.tryEntries=[{tryLoc:"root"}],t.forEach($,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(c.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=u,t.done=!0,t};return r.next=r}}return{next:L}}function L(){return{value:u,done:!0}}return m.prototype=_.constructor=v,v.constructor=m,v[r]=m.displayName="GeneratorFunction",i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,r in t||(t[r]="GeneratorFunction")),t.prototype=Object.create(_),t},i.awrap=function(t){return{__await:t}},k(x.prototype),x.prototype[n]=function(){return this},i.AsyncIterator=x,i.async=function(t,e,n,r){var o=new x(a(t,e,n,r));return i.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},k(_),_[r]="Generator",_[o]=function(){return this},_.toString=function(){return"[object Generator]"},i.keys=function(n){var r=[];for(var t in n)r.push(t);return r.reverse(),function t(){for(;r.length;){var e=r.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},i.values=C,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(M),!t)for(var e in this)"t"===e.charAt(0)&&c.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function t(t,e){return i.type="throw",i.arg=n,r.next=t,e&&(r.method="next",r.arg=u),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var a=c.call(o,"catchLoc"),s=c.call(o,"finallyLoc");if(a&&s){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&c.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;M(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:C(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=u),g}},i}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}});function gt(t,e,n,r,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,o)}var mt=function(s){return function(){var t=this,a=arguments;return new Promise(function(e,n){var r=s.apply(t,a);function o(t){gt(r,e,n,o,i,"next",t)}function i(t){gt(r,e,n,o,i,"throw",t)}o(void 0)})}};function vt(n){return Q(Object.keys(ft).join(","),pt)(function(t){function e(){return o(this,e),B(this,G(e).apply(this,arguments))}return V(e,_),i(e,[{key:"render",value:function(t){return p(n,t)}}]),e}())}var yt=vt(function(t){function e(){return o(this,e),B(this,G(e).apply(this,arguments))}return V(e,_),i(e,[{key:"componentDidMount",value:function(){if(this.props.error)throw new Error(this.props.error)}},{key:"componentDidUpdate",value:function(){if(this.props.error)throw new Error(this.props.error)}},{key:"render",value:function(t){var e=t.error;return e?p("div",{class:"gitting-error"},e):null}}]),e}()),bt=vt(function(t){function e(){return o(this,e),B(this,G(e).apply(this,arguments))}return V(e,_),i(e,[{key:"render",value:function(t){var e=t.issue,n=t.options,r=t.config,o=t.userInfo,i=t.isLogin,a=t.logout,s=t.login;return e?p("header",{class:"gitting-header"},p("a",{href:"https://github.com/".concat(n.owner,"/").concat(n.repo,"/issues/").concat(e.number),target:"_blank",class:"gitting-number"},e.comments||0," ",r.i18n("counts")),p("div",{class:"gitting-mate"},i()?p("span",null,p("a",{href:"#"},o.login),p("a",{href:"#",onClick:function(t){return a(t)}},r.i18n("logout"))):p("a",{href:"#",onClick:function(t){return s(n,t)}},r.i18n("login")),p("a",{href:"https://github.com/zhw2590582/gitting",target:"_blank"},"Gitting 2.0.6"))):null}}]),e}()),wt=vt(function(t){function e(){return o(this,e),B(this,G(e).apply(this,arguments))}return V(e,_),i(e,[{key:"render",value:function(t){return t.loading?p("div",{class:"gitting-loading"},p("div",{class:"lds-ellipsis"},p("div",null),p("div",null),p("div",null),p("div",null))):null}}]),e}()),_t=vt(function(t){function n(t){var e;return o(this,n),(e=B(this,G(n).call(this,t))).state={loading:!1,preview:!1,markdown:""},e}var e,r;return V(n,_),i(n,[{key:"onWrite",value:function(t){this.setState(function(){return{preview:!1}})}},{key:"onPreview",value:(r=mt(dt.mark(function t(e){var n,r,o,i,a;return dt.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.props,r=n.config,o=n.input,i=o.trim(),this.setState(function(){return{preview:!0,markdown:""}}),a="",i)return this.setState(function(){return{loading:!0}}),t.next=8,r.api.mdToHtml(i);t.next=12;break;case 8:a=t.sent,this.setState(function(){return{loading:!1}}),t.next=13;break;case 12:a=r.i18n("noPreview");case 13:this.setState(function(){return{markdown:a}});case 14:case"end":return t.stop()}},t,this)})),function(t){return r.apply(this,arguments)})},{key:"onSubmit",value:(e=mt(dt.mark(function t(e){var n,r,o,i,a,s,u,c,l;return dt.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.props,r=n.options,o=n.input,i=n.config,a=n.issue,s=n.throwError,u=n.setInput,c=o.trim()){t.next=4;break}return t.abrupt("return");case 4:return s(c.length>r.maxlength,"Word count exceeds limit: ".concat(c.length," / ").concat(r.maxlength)),this.setState(function(){return{loading:!0}}),t.next=8,i.api.creatComments(a.number,c);case 8:l=t.sent,s(!l||!l.id,"Comment failed!"),this.setState(function(){return{loading:!1,markdown:""}}),l.id&&(u(""),setTimeout(function(){lt(i.$container.querySelector(".gitting-load")).click()},100));case 12:case"end":return t.stop()}},t,this)})),function(t){return e.apply(this,arguments)})},{key:"render",value:function(t,e){var n=this,r=t.options,o=t.input,i=t.setInput,a=t.config,s=t.userInfo,u=t.login,c=t.isLogin,l=e.preview,f=e.markdown,h=e.loading;return p("div",{class:"gitting-body"},p("div",{class:"gitting-avatar"},p("img",{src:c()?s.avatar_url:r.avatar,alt:"@".concat(c()?s.login:"github")})),p("div",{class:"gitting-editor"},p("div",{style:{display:l?"":"none"},class:"gitting-markdown markdown-body",dangerouslySetInnerHTML:{__html:f}}),p("textarea",{style:{display:l?"none":""},class:"gitting-textarea",placeholder:a.i18n("leave"),maxlength:r.maxlength,spellcheck:!1,value:o,onInput:function(t){return i(t.target.value)}}),p("div",{class:"gitting-tip",style:{display:l?"none":""}},p("a",{href:"https://guides.github.com/features/mastering-markdown/",target:"_blank"},a.i18n("styling")),p("span",{class:"gitting-counts"},r.maxlength-o.length," / ",r.maxlength)),p("div",{class:"gitting-tool"},p("div",{class:"gitting-switch"},p("span",{class:l?"":"active",onClick:function(t){return n.onWrite(t)}},a.i18n("write")),p("span",{class:l?"active":"",onClick:function(t){return n.onPreview(t)}},a.i18n("preview"))),c()?p("button",{class:"gitting-send",onClick:function(t){return n.onSubmit(t)}},a.i18n("submit")):p("a",{class:"gitting-send",href:"#",onClick:function(t){return u(r,t)}},a.i18n("login")))),p(wt,{loading:h}))}}]),n}()),kt=W(function(t,e){t.exports=function(){var u="millisecond",p="second",d="minute",g="hour",m="day",v="week",y="month",c="quarter",b="year",o=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,l=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,i=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},t={s:i,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),o=n%60;return(e<=0?"+":"-")+i(r,2,"0")+":"+i(o,2,"0")},m:function(t,e){var n=12*(e.year()-t.year())+(e.month()-t.month()),r=t.clone().add(n,y),o=e-r<0,i=t.clone().add(n+(o?-1:1),y);return Number(-(n+(e-r)/(o?r-i:i-r))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:y,y:b,w:v,d:m,h:g,m:d,s:p,ms:u,Q:c}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},e={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},a="en",s={};s[a]=e;var f=function(t){return t instanceof _},r=function(t,e,n){var r;if(!t)return null;if("string"==typeof t)s[t]&&(r=t),e&&(s[t]=e,r=t);else{var o=t.name;s[o]=t,r=o}return n||(a=r),r},h=function(t,e,n){if(f(t))return t.clone();var r=e?"string"==typeof e?{format:e,pl:n}:e:{};return r.date=t,new _(r)},w=t;w.l=r,w.i=f,w.w=function(t,e){return h(t,{locale:e.$L,utc:e.$u})};var _=function(){function t(t){this.$L=this.$L||r(t.locale,null,!0)||a,this.parse(t)}var e=t.prototype;return e.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(w.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(o);if(r)return n?new Date(Date.UTC(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)):new Date(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)}return new Date(e)}(t),this.init()},e.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},e.$utils=function(){return w},e.isValid=function(){return!("Invalid Date"===this.$d.toString())},e.isSame=function(t,e){var n=h(t);return this.startOf(e)<=n&&n<=this.endOf(e)},e.isAfter=function(t,e){return h(t)<this.startOf(e)},e.isBefore=function(t,e){return this.endOf(e)<h(t)},e.$g=function(t,e,n){return w.u(t)?this[e]:this.set(n,t)},e.year=function(t){return this.$g(t,"$y",b)},e.month=function(t){return this.$g(t,"$M",y)},e.day=function(t){return this.$g(t,"$W",m)},e.date=function(t){return this.$g(t,"$D","date")},e.hour=function(t){return this.$g(t,"$H",g)},e.minute=function(t){return this.$g(t,"$m",d)},e.second=function(t){return this.$g(t,"$s",p)},e.millisecond=function(t){return this.$g(t,"$ms",u)},e.unix=function(){return Math.floor(this.valueOf()/1e3)},e.valueOf=function(){return this.$d.getTime()},e.startOf=function(t,e){var r=this,o=!!w.u(e)||e,n=w.p(t),i=function(t,e){var n=w.w(r.$u?Date.UTC(r.$y,e,t):new Date(r.$y,e,t),r);return o?n:n.endOf(m)},a=function(t,e){return w.w(r.toDate()[t].apply(r.toDate(),(o?[0,0,0,0]:[23,59,59,999]).slice(e)),r)},s=this.$W,u=this.$M,c=this.$D,l="set"+(this.$u?"UTC":"");switch(n){case b:return o?i(1,0):i(31,11);case y:return o?i(1,u):i(0,u+1);case v:var f=this.$locale().weekStart||0,h=(s<f?s+7:s)-f;return i(o?c-h:c+(6-h),u);case m:case"date":return a(l+"Hours",0);case g:return a(l+"Minutes",1);case d:return a(l+"Seconds",2);case p:return a(l+"Milliseconds",3);default:return this.clone()}},e.endOf=function(t){return this.startOf(t,!1)},e.$set=function(t,e){var n,r=w.p(t),o="set"+(this.$u?"UTC":""),i=((n={}).day=o+"Date",n.date=o+"Date",n[y]=o+"Month",n[b]=o+"FullYear",n[g]=o+"Hours",n[d]=o+"Minutes",n[p]=o+"Seconds",n[u]=o+"Milliseconds",n)[r],a=r===m?this.$D+(e-this.$W):e;if(r===y||r===b){var s=this.clone().set("date",1);s.$d[i](a),s.init(),this.$d=s.set("date",Math.min(this.$D,s.daysInMonth())).toDate()}else i&&this.$d[i](a);return this.init(),this},e.set=function(t,e){return this.clone().$set(t,e)},e.get=function(t){return this[w.p(t)]()},e.add=function(n,t){var e,r=this;n=Number(n);var o=w.p(t),i=function(t){var e=new Date(r.$d);return e.setDate(e.getDate()+t*n),w.w(e,r)};if(o===y)return this.set(y,this.$M+n);if(o===b)return this.set(b,this.$y+n);if(o===m)return i(1);if(o===v)return i(7);var a=((e={})[d]=6e4,e[g]=36e5,e[p]=1e3,e)[o]||1,s=this.valueOf()+n*a;return w.w(s,this)},e.subtract=function(t,e){return this.add(-1*t,e)},e.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var n=t||"YYYY-MM-DDTHH:mm:ssZ",r=w.z(this),o=this.$locale(),i=o.weekdays,a=o.months,s=function(t,e,n,r){return t&&t[e]||n[e].substr(0,r)},u=function(t){return w.s(e.$H%12||12,t,"0")},c={YY:String(this.$y).slice(-2),YYYY:String(this.$y),M:String(this.$M+1),MM:w.s(this.$M+1,2,"0"),MMM:s(o.monthsShort,this.$M,a,3),MMMM:a[this.$M],D:String(this.$D),DD:w.s(this.$D,2,"0"),d:String(this.$W),dd:s(o.weekdaysMin,this.$W,i,2),ddd:s(o.weekdaysShort,this.$W,i,3),dddd:i[this.$W],H:String(this.$H),HH:w.s(this.$H,2,"0"),h:u(1),hh:u(2),a:this.$H<12?"am":"pm",A:this.$H<12?"AM":"PM",m:String(this.$m),mm:w.s(this.$m,2,"0"),s:String(this.$s),ss:w.s(this.$s,2,"0"),SSS:w.s(this.$ms,3,"0"),Z:r};return n.replace(l,function(t,e){return e||c[t]||r.replace(":","")})},e.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},e.diff=function(t,e,n){var r,o=w.p(e),i=h(t),a=6e4*(i.utcOffset()-this.utcOffset()),s=this-i,u=w.m(this,i);return u=((r={})[b]=u/12,r[y]=u,r[c]=u/3,r[v]=(s-a)/6048e5,r.day=(s-a)/864e5,r[g]=s/36e5,r[d]=s/6e4,r[p]=s/1e3,r)[o]||s,n?u:w.a(u)},e.daysInMonth=function(){return this.endOf(y).$D},e.$locale=function(){return s[this.$L]},e.locale=function(t,e){if(!t)return this.$L;var n=this.clone();return n.$L=r(t,e,!0),n},e.clone=function(){return w.w(this.toDate(),this)},e.toDate=function(){return new Date(this.$d)},e.toJSON=function(){return this.toISOString()},e.toISOString=function(){return this.$d.toISOString()},e.toString=function(){return this.$d.toUTCString()},t}();return h.prototype=_.prototype,h.extend=function(t,e){return t(e,_,h),h},h.locale=r,h.isDayjs=f,h.unix=function(t){return h(1e3*t)},h.en=s[a],h.Ls=s,h}()}),xt=W(function(t,e){t.exports=function(t,e,h){var n=e.prototype;h.en.relativeTime={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};var r=function(t,e,n,r){for(var o,i,a=n.$locale().relativeTime,s=[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],u=s.length,c=0;c<u;c+=1){var l=s[c];l.d&&(o=r?h(t).diff(n,l.d,!0):n.diff(t,l.d,!0));var f=Math.ceil(Math.abs(o));if(f<=l.r||!l.r){i=a[l.l].replace("%d",f);break}}return e?i:(0<o?a.future:a.past).replace("%s",i)};n.to=function(t,e){return r(t,e,this,!0)},n.from=function(t,e){return r(t,e,this)},n.toNow=function(t){return this.to(h(),t)},n.fromNow=function(t){return this.from(h(),t)}}});W(function(t,e){t.exports=function(t){t=t&&t.hasOwnProperty("default")?t.default:t;var e={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(t,e){switch(e){case"W":return t+"周";default:return t+"日"}},weekStart:1,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"}};return t.locale(e,null,!0),e}(kt)}),W(function(t,e){t.exports={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")}});kt.extend(xt);var St=vt(function(t){t.options;var e=t.config,n=t.item,r=t.reply;return p("div",{className:"gitting-comment-item",key:n.id,"data-id":n.id},p("div",{className:"gitting-avatar"},p("a",{href:n.user.html_url,target:"_blank"},p("img",{src:n.user.avatar_url,alt:"@".concat(n.user.login)}))),p("div",{className:"gitting-content gitting-caret"},p("div",{className:"gitting-content-body markdown-body",dangerouslySetInnerHTML:{__html:n.body_html}}),p("div",{className:"gitting-content-mate"},p("span",null,p("a",{className:"gitting-content-name",href:n.user.html_url,target:"_blank"},n.user.login),p("span",{className:"gitting-content-time","data-time":n.created_at},e.i18n("published")," ",kt(n.created_at).fromNow())),p("a",{className:"gitting-content-reply",href:"#",onClick:function(t){return r(n,t)}},e.i18n("reply")))))}),$t=vt(function(t){function n(t){var e;return o(this,n),e=B(this,G(n).call(this,t)),kt.locale(t.options.language),e.state={loading:!1,loadMore:!1,page:1},e.reply=e.reply.bind(F(e)),e}var e,r;return V(n,_),i(n,[{key:"componentDidMount",value:(r=mt(dt.mark(function t(){var e,n,r,o,i,a,s;return dt.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.setState(function(){return{loading:!0}}),e=this.props,n=e.options,r=e.config,o=e.setComments,i=e.issue,a=this.state.page,i.number)return t.next=6,r.api.getComments(i.number,a);t.next=9;break;case 6:s=t.sent,o(s),n.perPage===s.length&&this.setState(function(){return{page:a+1}});case 9:this.setState(function(){return{loading:!1}});case 10:case"end":return t.stop()}},t,this)})),function(){return r.apply(this,arguments)})},{key:"reply",value:function(t,e){e.preventDefault();var n=this.props,r=n.input,o=n.setInput,i=n.config;o(r+"".concat(r?"\n":"","> @").concat(t.user.login,"\n> ").concat(t.body,"\n")),lt(i.$container)}},{key:"loadMore",value:(e=mt(dt.mark(function t(e){var n,r,o,i,a,s,u;return dt.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),this.setState(function(){return{loadMore:!0}}),n=this.props,r=n.options,o=n.config,i=n.setComments,a=n.issue,s=this.state.page,a.number)return t.next=7,o.api.getComments(a.number,s);t.next=10;break;case 7:u=t.sent,i(u),r.perPage===u.length&&this.setState(function(){return{page:s+1}});case 10:this.setState(function(){return{loadMore:!1}});case 11:case"end":return t.stop()}},t,this)})),function(t){return e.apply(this,arguments)})},{key:"render",value:function(t,e){var n=this,r=t.options,o=t.config,i=t.comments,a=e.loading,s=e.loadMore;return p("div",{className:"gitting-comments"},a?p(wt,{loading:a}):i.map(function(t){return p(St,{options:r,config:o,item:t,key:t.id,reply:n.reply})}),s?p("span",{class:"gitting-load"},o.i18n("loading")):p("a",{href:"#",class:"gitting-load",onClick:function(t){return n.loadMore(t)}},o.i18n("loadMore")))}}]),n}()),Mt=vt(function(t){function n(t){var e;return o(this,n),(e=B(this,G(n).call(this,t))).state={loading:!1,init:!1},e}var e,r;return V(n,_),i(n,[{key:"componentDidMount",value:(r=mt(dt.mark(function t(){var e,n,r,o,i,a,s,u,c,l,f,h,p,d,g;return dt.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.setState(function(){return{loading:!0}}),e=this.props,n=e.options,r=e.config,o=e.throwError,i=e.setUserInfo,a=e.setIssue,s=(window.location.href.match(/([^?=&]+)(=([^&]*))/g)||[]).reduce(function(t,e){return t[e.slice(0,e.indexOf("="))]=e.slice(e.indexOf("=")+1),t},{}),u=s.code)return t.next=6,r.api.getToken(u);t.next=17;break;case 6:return c=t.sent,o(!c.access_token,"Can not get token, Please login again!"),st("token",c.access_token),t.next=11,r.api.getUserInfo(c.access_token);case 11:l=t.sent,o(!l.id,"Can not get user info, Please login again!"),st("userInfo",l),f=at("redirect_uri"),o(!f,"Can not get redirect url, Please login again!"),window.history.replaceState(null,"",f);case 17:if(i(at("userInfo")),0<Number(n.number))return h=null,t.prev=20,t.next=23,r.api.getIssueById(n.number);t.next=32;break;case 23:h=t.sent,a(h),t.next=30;break;case 27:t.prev=27,t.t0=t.catch(20),h&&h.number||(this.setState(function(){return{init:!0}}),o(!0,"Failed to get issue by number: ".concat(n.number,", Do you want to initialize an new issue?")));case 30:t.next=39;break;case 32:return p=n.labels.concat(n.id).join(","),t.next=35,r.api.getIssueByLabel(p);case 35:d=t.sent,(g=Array.isArray(d)&&d.length?d[0]:null)&&g.number||(this.setState(function(){return{init:!0}}),o(!0,"Failed to get issue by labels: ".concat(p,", Do you want to initialize an new issue?"))),a(g);case 39:this.setState(function(){return{loading:!1}});case 40:case"end":return t.stop()}},t,this,[[20,27]])})),function(){return r.apply(this,arguments)})},{key:"onInit",value:(e=mt(dt.mark(function t(){var e,n,r,o,i,a,s,u,c;return dt.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.props,n=e.options,r=e.config,o=e.userInfo,i=e.isLogin,a=e.throwError,s=e.login,i()){t.next=4;break}return s(n),t.abrupt("return");case 4:return a(!n.admin.includes(o.login),"You have no permission to initialize this issue"),u={title:document.title,body:"".concat(document.title,"\n").concat(window.location.href),labels:n.labels.concat(n.id)},t.next=8,r.api.creatIssues(u);case 8:c=t.sent,a(!c||!c.number,"Initialize issue failed: ".concat(JSON.stringify(u))),window.location.reload();case 11:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)})},{key:"render",value:function(t,e){var n=this,r=t.options,o=t.config,i=e.loading,a=e.init;return p("div",{class:"gitting-container gitting-theme-".concat(r.theme)},i?p(wt,{loading:i}):p("div",null,p(yt,{options:r,config:o}),a?p("button",{className:"gitting-init",onClick:function(t){return n.onInit(t)}},o.i18n("init")):p("div",null,p(bt,{options:r,config:o}),p(_t,{options:r,config:o}),p($t,{options:r,config:o}))))}}]),n}()),Dt=function(t){function e(){return o(this,e),B(this,G(e).apply(this,arguments))}return V(e,_),i(e,[{key:"render",value:function(t){var e=t.options,n=t.config;return p(K,{store:ht},p(Mt,{options:e,config:n}))}}]),e}();function Ct(r){var t=new AbortController,o=function(a){return function(t,e,n,r){t=t.toUpperCase(),n=n&&JSON.stringify(n);var o={"Content-Type":"application/json",Accept:"application/json"};r&&(o=Object.assign({},o,r));var i=at("token");return i&&(o.Authorization="token ".concat(i)),fetch(e,{method:t,headers:o,body:n,signal:a.signal}).then(function(t){return 404===t.status?Promise.reject("Unauthorized."):401!==t.status?"text/html"===o.Accept?t.text():t.json():(ut(),void window.location.reload())}).catch(function(t){console.warn(t,e)})}}(t),i="https://api.github.com/repos/".concat(r.owner,"/").concat(r.repo,"/issues"),a={client_id:r.clientID,client_secret:r.clientSecret};return{getToken:function(t){var e=Object.assign({},a,{code:t,redirect_uri:location.href});return o("get","".concat(r.proxy,"?").concat(ct(e)))},getUserInfo:function(t){return o("get","https://api.github.com/user?access_token=".concat(t))},getIssueByLabel:function(t){var e=Object.assign({},a,{labels:t,t:Date.now()});return o("get","".concat(i,"?").concat(ct(e)))},getIssueById:function(t){var e=Object.assign({},a,{t:Date.now()});return o("get","".concat(i,"/").concat(t,"?").concat(ct(e)))},getComments:function(t,e){var n=Object.assign({},a,{per_page:r.perPage,page:e,t:Date.now()});return o("get","".concat(i,"/").concat(t,"/comments?").concat(ct(n)),null,{Accept:"application/vnd.github.v3.full+json"})},creatIssues:function(t){var e=Object.assign({},a,t,{t:Date.now()});return o("post",i,e)},creatComments:function(t,e){var n=Object.assign({},a,{body:e,t:Date.now()});return o("post","".concat(i,"/").concat(t,"/comments"),n,{Accept:"application/vnd.github.v3.full+json"})},mdToHtml:function(t){var e=Object.assign({},a,{text:t,t:Date.now()});return o("post","https://api.github.com/markdown",e,{Accept:"text/html"})},abort:function(){t&&t.abort&&t.abort()}}}var Lt={"zh-cn":{init:"登录以初始化一个评论",counts:"条评论",login:"登录",logout:"注销",leave:"发表评论",styling:"支持使用Markdown进行样式设置",write:"编写",preview:"预览",noPreview:"无预览内容",submit:"提交",reply:"回复",loadMore:"加载更多",loading:"加载中...",loadEnd:"加载完毕",published:"发表于"},en:{init:"Login then initialize a issue",counts:"comments",login:"Login",logout:"Logout",leave:"Leave a comment",styling:"Styling with Markdown is supported",write:"Write",preview:"Preview",noPreview:"Nothing to preview",submit:"Submit",reply:"Reply",loadMore:"Load More",loading:"loading...",loadEnd:"Load completed",published:"Published on"}};return function(){function n(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};o(this,n),this.options=Object.assign({},n.DEFAULT,t),["clientID","clientSecret","repo","owner"].forEach(function(t){if(!e.options[t].trim())throw new Error("The options.".concat(t," can not be empty"))}),this.config={$root:null,$container:null,api:Ct(this.options),i18n:function(t){var e=Lt[t]||Lt["zh-cn"];return function(t){return e[t]||"Unmath key: ".concat(t)}}(this.options.language)}}return i(n,[{key:"render",value:function(t){return this.config.$container=t instanceof Element?t:document.querySelector(t),this.config.$root=k(p(Dt,{options:this.options,config:this.config}),this.config.$container),this}},{key:"destroy",value:function(){return k(null,this.config.$container,this.config.$root),this}},{key:"abort",value:function(){return this.config.api.abort(),this}}],[{key:"DEFAULT",get:function(){return{clientID:"",clientSecret:"",repo:"",owner:"",admin:[],theme:"white",id:window.location.pathname,number:-1,labels:["Gitting"],language:"zh-cn",perPage:10,maxlength:500,avatar:"https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png",proxy:"https://cors-anywhere.herokuapp.com/https://github.com/login/oauth/access_token"}}}]),n}()});
